"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[815],{3815:(zt,U,s)=>{s.r(U),s.d(U,{SettingsModule:()=>Et});var R=s(9132),S=s(6895),r=s(4006),I=s(148),m=s(5412),A=s(7392),Z=s(3238),f=s(8739),x=s(4385),h=s(7009),d=s(6308),l=s(7155),q=s(266),V=s(1948),g=s(9549),y=s(4144),B=s(6709),Q=s(5655),O=s(7084),_=s(3848),J=s(8425),k=s(6338),j=s(3546),G=s(455),P=s(7957),M=s(4517),C=s(4859),t=s(4650),b=s(5861),w=s(9555),D=s(3536);function H(o,i){if(1&o&&(t.TgZ(0,"mat-option",12),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}let Y=(()=>{class o{constructor(e,n,a,c,u){this.fb=e,this._dialogRef=n,this.data=a,this._accountsService=c,this._snackBar=u,this.initVarValues(),this.userForm=this.createForm(this.data?this.data.editUser:null)}ngOnInit(){this.apiSetup()}ngAfterViewInit(){}ngOnDestroy(){this.initVarValues()}onAddAccount(){var e=this;return(0,b.Z)(function*(){const n=e.userForm.value;!e.validateForm()||"add"===e.formType&&(yield e.validateExist(n.email))||("edit"===e.formType&&(n.id=e.data.editUser.id),e._dialogRef.close(n))})()}onCancel(){this._dialogRef.close(void 0)}openSnackBar(e){this._snackBar.open(e,null,{duration:2e3,horizontalPosition:"right",verticalPosition:"top"})}createForm(e=null){const n=this.fb.group({name:new r.NI(e?e.name:null,[r.kI.required]),email:new r.NI(e?e.email:null,[r.kI.required,r.kI.email]),password:new r.NI(null,[r.kI.required]),role:new r.NI(e?e.role:null,[r.kI.required])});return"edit"===this.formType&&n.get("password").removeValidators(r.kI.required),n}apiSetup(){}validateForm(){let e=!0;const n=this.userForm.controls;return n.name.errors&&n.name.errors.required?(this.openSnackBar("Name is required"),e=!1):n.email.errors&&n.email.errors.required?(this.openSnackBar("Email is required"),e=!1):n.email.errors&&n.email.errors.email?(this.openSnackBar("Email is invalid"),e=!1):n.password.errors&&n.password.errors.required?(this.openSnackBar("Password is required"),e=!1):n.role.errors&&n.role.errors.required&&(this.openSnackBar("Role is required"),e=!1),e}validateExist(e){var n=this;return(0,b.Z)(function*(){let a=!1;return yield n._accountsService.getUsers({email:e}).then(c=>{c.success&&c.data&&(a=!0,n.openSnackBar("Email is exist"))}),a})()}initVarValues(){this.settings={roles:Object.keys(w.uU)},this.formType=this.data?this.data.formType:"add",this.title="add"===this.formType?"Add User":"Edit User: "+this.data.editUser.name||0,this.btnConfirmTitle="add"===this.formType?"Add":"Save",this.hidePassword=!0}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(m.so),t.Y36(m.WI),t.Y36(D.i),t.Y36(h.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["account-form"]],decls:29,vars:8,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"gap-5",3,"formGroup"],["matInput","","formControlName","name"],["type","email","matInput","","formControlName","email"],["matInput","","formControlName","password",3,"type"],["mat-icon-button","","matSuffix","",3,"click"],["formControlName","role"],[3,"value",4,"ngFor","ngForOf"],["align","end"],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"],[3,"value"]],template:function(e,n){1&e&&(t.TgZ(0,"h2",0),t._uU(1),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"mat-form-field")(5,"mat-label"),t._uU(6,"Name"),t.qZA(),t._UZ(7,"input",3),t.qZA(),t.TgZ(8,"mat-form-field")(9,"mat-label"),t._uU(10,"Email"),t.qZA(),t._UZ(11,"input",4),t.qZA(),t.TgZ(12,"mat-form-field")(13,"mat-label"),t._uU(14,"Password"),t.qZA(),t._UZ(15,"input",5),t.TgZ(16,"button",6),t.NdJ("click",function(){return n.hidePassword=!n.hidePassword}),t.TgZ(17,"mat-icon"),t._uU(18),t.qZA()()(),t.TgZ(19,"mat-form-field")(20,"mat-label"),t._uU(21,"Role"),t.qZA(),t.TgZ(22,"mat-select",7),t.YNc(23,H,2,2,"mat-option",8),t.qZA()()()(),t.TgZ(24,"mat-dialog-actions",9)(25,"button",10),t.NdJ("click",function(){return n.onCancel()}),t._uU(26,"Cancel"),t.qZA(),t.TgZ(27,"button",11),t.NdJ("click",function(){return n.onAddAccount()}),t._uU(28),t.qZA()()),2&e&&(t.xp6(1),t.Oqu(n.title),t.xp6(2),t.Q6J("formGroup",n.userForm),t.xp6(12),t.Q6J("type",n.hidePassword?"password":"text"),t.xp6(1),t.uIk("aria-label","Hide password")("aria-pressed",n.hidePassword),t.xp6(2),t.Oqu(n.hidePassword?"visibility_off":"visibility"),t.xp6(5),t.Q6J("ngForOf",n.settings.roles),t.xp6(5),t.Oqu(n.btnConfirmTitle))},dependencies:[S.sg,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,C.lW,m.uh,m.xY,m.H8,A.Hw,g.KE,g.hX,g.R9,x.gD,Z.ey,y.Nt],encapsulation:2}),o})();var $=s(8951),E=s(3385),N=s(1683);function z(o,i){1&o&&(t.TgZ(0,"th",18),t._uU(1," ID "),t.qZA())}function X(o,i){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.id," ")}}function L(o,i){1&o&&(t.TgZ(0,"th",18),t._uU(1," Name "),t.qZA())}function W(o,i){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function K(o,i){1&o&&(t.TgZ(0,"th",18),t._uU(1," Email "),t.qZA())}function tt(o,i){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.email," ")}}function et(o,i){1&o&&(t.TgZ(0,"th",18),t._uU(1," Role "),t.qZA())}function ot(o,i){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.role," ")}}function nt(o,i){1&o&&(t.TgZ(0,"th",18),t._uU(1," Status "),t.qZA())}function it(o,i){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.status||"None"," ")}}function at(o,i){1&o&&t._UZ(0,"th",18)}function st(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",20)(1,"button",21),t.NdJ("click",function(){const c=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.editAccountDialog(c))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",22),t.NdJ("click",function(){const c=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.removeAccountDialog(c))}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}}function ct(o,i){1&o&&t._UZ(0,"tr",23)}function rt(o,i){1&o&&t._UZ(0,"tr",24)}function lt(o,i){1&o&&(t.TgZ(0,"tr",25)(1,"td",26),t._uU(2,"No data matching the filter"),t.qZA()())}const ut=function(){return[5,10,25,100]};let mt=(()=>{class o{constructor(e,n,a,c){this._accountsService=e,this._snackBar=n,this._dialog=a,this._fuseConfirmation=c}ngOnInit(){this.initVarValues(),this.apiSetup()}ngOnDestroy(){this.initVarValues()}addAccountDialog(){this._dialog.open(Y,{width:"500px"}).afterClosed().subscribe(n=>{void 0!==n&&(n.password!==n.confirmPassword&&(n.password=E.c.makeHash(n.password)),this._accountsService.addUser(n).then(a=>{a.success?(this.openSnackBar("Account successfully added"),this.onReloadData()):this.openSnackBar(a.message)}))})}editAccountDialog(e){this._dialog.open(Y,{width:"500px",data:{formType:"edit",editUser:e}}).afterClosed().subscribe(a=>{void 0!==a&&this._accountsService.editUser(a).then(c=>{c.success?(this.openSnackBar("Account successfully updated"),this.onReloadData()):this.openSnackBar(c.message)})})}removeAccountDialog(e){this._fuseConfirmation.open({title:"Delete Account",message:"Are you sure you want to delete this account?",icon:{show:!0,name:"heroicons_outline:exclamation",color:"warning"},actions:{confirm:{show:!0,label:"Delete",color:"warn"},cancel:{show:!0,label:"Cancel"}}}).afterClosed().subscribe(a=>{"confirmed"===a&&this._accountsService.removeUser(e.id).then(c=>{c.success?(this.openSnackBar("Account successfully deleted"),this.onReloadData()):this.openSnackBar(c.message)})})}apiSetup(){this._accountsService.getUsers({authid:this.authUser.id}).then(e=>{e.success&&e.data?this.usersDataSource.data=e.data:this.openSnackBar(e.message)})}onReloadData(){this.apiSetup(),void 0!==this.table&&this.table.renderRows()}initVarValues(){this.usersDataSource=new l.by([]),this.usersDisplayedColumns=["id","name","email","role","status","action"],this.authUser=$.e.getUser()}openSnackBar(e){this._snackBar.open(e,null,{duration:3e3,horizontalPosition:"right",verticalPosition:"top"})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(D.i),t.Y36(h.ux),t.Y36(m.uw),t.Y36(N.R))},o.\u0275cmp=t.Xpm({type:o,selectors:[["account"]],viewQuery:function(e,n){if(1&e&&(t.Gf(l.BZ,5),t.Gf(f.NW,5),t.Gf(d.YE,5)),2&e){let a;t.iGM(a=t.CRH())&&(n.table=a.first),t.iGM(a=t.CRH())&&(n.paginator=a.first),t.iGM(a=t.CRH())&&(n.sort=a.first)}},decls:29,vars:5,consts:[[1,"h-full","min-h-300","max-h-fit"],[1,"flex","justify-end","items-center","mb-5"],["mat-raised-button","","color","primary",3,"click"],["webMode","",1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","class","px-4 py-2 font-bold text-primary",4,"matHeaderCellDef"],["mat-cell","","class","p-4 font-medium text-sm text-secondary",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","role"],["matColumnDef","status"],["matColumnDef","action"],["mat-cell","","class","p-4 font-medium text-sm text-secondary flex justify-end",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-hover",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of AR transaction",3,"pageSizeOptions"],["mat-header-cell","",1,"px-4","py-2","font-bold","text-primary"],["mat-cell","",1,"p-4","font-medium","text-sm","text-secondary"],["mat-cell","",1,"p-4","font-medium","text-sm","text-secondary","flex","justify-end"],["mat-icon-button","","color","success",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row","",1,"hover:bg-hover"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return n.addAccountDialog()}),t._uU(3,"Add"),t.qZA()(),t.TgZ(4,"section")(5,"div",3)(6,"table",4),t.ynx(7,5),t.YNc(8,z,2,0,"th",6),t.YNc(9,X,2,1,"td",7),t.BQk(),t.ynx(10,8),t.YNc(11,L,2,0,"th",6),t.YNc(12,W,2,1,"td",7),t.BQk(),t.ynx(13,9),t.YNc(14,K,2,0,"th",6),t.YNc(15,tt,2,1,"td",7),t.BQk(),t.ynx(16,10),t.YNc(17,et,2,0,"th",6),t.YNc(18,ot,2,1,"td",7),t.BQk(),t.ynx(19,11),t.YNc(20,nt,2,0,"th",6),t.YNc(21,it,2,1,"td",7),t.BQk(),t.ynx(22,12),t.YNc(23,at,1,0,"th",6),t.YNc(24,st,7,0,"td",13),t.BQk(),t.YNc(25,ct,1,0,"tr",14),t.YNc(26,rt,1,0,"tr",15),t.YNc(27,lt,3,0,"tr",16),t.qZA(),t._UZ(28,"mat-paginator",17),t.qZA()()()),2&e&&(t.xp6(6),t.Q6J("dataSource",n.usersDataSource),t.xp6(19),t.Q6J("matHeaderRowDef",n.usersDisplayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.usersDisplayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(4,ut)))},dependencies:[C.lW,A.Hw,f.NW,d.YE,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,l.Ee],encapsulation:2}),o})();var F=s(2340),dt=s(646),pt=s(529);let ft=(()=>{class o{constructor(e,n){this._fuseLoadingService=e,this._httpClient=n}getLogs(e){let n=F.N.server+"/get/audit.json?";return e.id&&(n+="id="+e.userid+"&"),e.userid&&(n+="userid="+e.userid+"&"),void 0!==e.from&&void 0!==e.to&&(n+="from="+e.from+"&to="+e.to+"&"),new Promise((a,c)=>{this._fuseLoadingService.show(),this._httpClient.get(n).subscribe(u=>{a(u),this._fuseLoadingService.hide()})})}restore(e){return new Promise((a,c)=>{this._fuseLoadingService.show()})}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(dt.c),t.LFG(pt.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function gt(o,i){1&o&&(t.TgZ(0,"th",16),t._uU(1," ID "),t.qZA())}function ht(o,i){if(1&o&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.id," ")}}function _t(o,i){1&o&&(t.TgZ(0,"th",16),t._uU(1," Date "),t.qZA())}function At(o,i){if(1&o&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.created_at," ")}}function Zt(o,i){1&o&&(t.TgZ(0,"th",16),t._uU(1," USER "),t.qZA())}function Ct(o,i){if(1&o&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.created_by," ")}}function Tt(o,i){1&o&&(t.TgZ(0,"th",16),t._uU(1," Action "),t.qZA())}function vt(o,i){if(1&o&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.action," ")}}function St(o,i){1&o&&(t.TgZ(0,"th",16),t._uU(1," Table "),t.qZA())}function xt(o,i){if(1&o&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.talbe_name," ")}}function yt(o,i){1&o&&(t.TgZ(0,"th",16),t._uU(1," Old Value "),t.qZA())}function Nt(o,i){if(1&o&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.old_value||"None"," ")}}function Ut(o,i){1&o&&(t.TgZ(0,"th",16),t._uU(1," New Value "),t.qZA())}function bt(o,i){if(1&o&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.new_value||"None"," ")}}function wt(o,i){1&o&&t._UZ(0,"tr",18)}function Dt(o,i){1&o&&t._UZ(0,"tr",19)}function Yt(o,i){1&o&&(t.TgZ(0,"tr",20)(1,"td",21),t._uU(2,"No data matching the filter"),t.qZA()())}const Ft=function(){return[5,10,25,100]};let Rt=(()=>{class o{constructor(e,n,a,c){this._auditService=e,this._snackBar=n,this._dialog=a,this._fuseConfirmation=c}ngOnInit(){this.initVarValues(),this.onReloadData()}ngOnDestroy(){this.initVarValues()}ngAfterViewInit(){this.logDataSources.paginator=this.paginator,this.logDataSources.sort=this.sort}apiSetup(){this._auditService.getLogs({}).then(e=>{e.success&&e.data?this.logDataSources.data=e.data:this.openSnackBar(e.message)})}onReloadData(){this.apiSetup(),void 0!==this.table&&this.table.renderRows()}initVarValues(){this.logDataSources=new l.by([]),this.logDisplayedColumns=["id","created_by","created_at","action","table_name","old_value","new_value"]}openSnackBar(e){this._snackBar.open(e,null,{duration:3e3,horizontalPosition:"right",verticalPosition:"top"})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(ft),t.Y36(h.ux),t.Y36(m.uw),t.Y36(N.R))},o.\u0275cmp=t.Xpm({type:o,selectors:[["audit"]],viewQuery:function(e,n){if(1&e&&(t.Gf(l.BZ,5),t.Gf(f.NW,5),t.Gf(d.YE,5)),2&e){let a;t.iGM(a=t.CRH())&&(n.table=a.first),t.iGM(a=t.CRH())&&(n.paginator=a.first),t.iGM(a=t.CRH())&&(n.sort=a.first)}},decls:29,vars:5,consts:[[1,"h-full","min-h-300","max-h-fit"],["webMode","",1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","class","px-4 py-2 font-bold text-primary","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","p-4 font-medium text-sm text-secondary",4,"matCellDef"],["matColumnDef","created_at"],["matColumnDef","created_by"],["matColumnDef","action"],["matColumnDef","table_name"],["matColumnDef","old_value"],["matColumnDef","new_value"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-hover",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of log",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header","",1,"px-4","py-2","font-bold","text-primary"],["mat-cell","",1,"p-4","font-medium","text-sm","text-secondary"],["mat-header-row",""],["mat-row","",1,"hover:bg-hover"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"section")(2,"div",1)(3,"table",2),t.ynx(4,3),t.YNc(5,gt,2,0,"th",4),t.YNc(6,ht,2,1,"td",5),t.BQk(),t.ynx(7,6),t.YNc(8,_t,2,0,"th",4),t.YNc(9,At,2,1,"td",5),t.BQk(),t.ynx(10,7),t.YNc(11,Zt,2,0,"th",4),t.YNc(12,Ct,2,1,"td",5),t.BQk(),t.ynx(13,8),t.YNc(14,Tt,2,0,"th",4),t.YNc(15,vt,2,1,"td",5),t.BQk(),t.ynx(16,9),t.YNc(17,St,2,0,"th",4),t.YNc(18,xt,2,1,"td",5),t.BQk(),t.ynx(19,10),t.YNc(20,yt,2,0,"th",4),t.YNc(21,Nt,2,1,"td",5),t.BQk(),t.ynx(22,11),t.YNc(23,Ut,2,0,"th",4),t.YNc(24,bt,2,1,"td",5),t.BQk(),t.YNc(25,wt,1,0,"tr",12),t.YNc(26,Dt,1,0,"tr",13),t.YNc(27,Yt,3,0,"tr",14),t.qZA(),t._UZ(28,"mat-paginator",15),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("dataSource",n.logDataSources),t.xp6(22),t.Q6J("matHeaderRowDef",n.logDisplayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.logDisplayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(4,Ft)))},dependencies:[f.NW,d.YE,d.nU,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,l.Ee],encapsulation:2}),o})();var It=s(9765),qt=s(6909);function Vt(o,i){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.code),t.xp6(1),t.hij(" ",e.code+" - "+e.name," ")}}function Bt(o,i){if(1&o&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.acct_code),t.xp6(1),t.hij(" ",e.acct_name," ")}}function Qt(o,i){if(1&o&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.acct_code),t.xp6(1),t.hij(" ",e.acct_name," ")}}function Ot(o,i){if(1&o&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.acct_code),t.xp6(1),t.hij(" ",e.acct_name," ")}}function Jt(o,i){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.code),t.xp6(1),t.hij(" ",e.code+" - "+e.name," ")}}function kt(o,i){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.code),t.xp6(1),t.hij(" ",e.code+" - "+e.name," ")}}function jt(o,i){if(1&o&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.code),t.xp6(1),t.hij(" ",e.code+" - "+e.name," ")}}let Gt=(()=>{class o{constructor(e,n,a,c,u){this._settingsService=e,this._othersSettingsService=n,this._snackBar=a,this._fuseConfirmation=c,this._formBuilder=u,this.initVarValues()}ngOnInit(){this.apiSetup()}ngOnDestroy(){this.initVarValues()}ngAfterViewInit(){this.inputsValueChange()}saveRegularSupport(){this._fuseConfirmation.open({title:"Are you sure?",message:"You are about to save AR form settings",icon:{show:!0,name:"heroicons_outline:information-circle",color:"info"},actions:{confirm:{show:!0,label:"Yes",color:"primary"},cancel:{show:!0,label:"No"}},dismissible:!0}).afterClosed().subscribe(n=>{if("confirmed"===n){const a=this.settings.config,c=this.regSuppForm.value;if(a.regular_support.ar_form=a.regular_support.ar_form?a.regular_support.ar_form:{},c.type){const u=c.type.replace(" ","_");a.regular_support.ar_form[u]={type:c.type,income_acct:c.income_acct,income_desc:c.income_desc,rIncome_acct:c.rIncome_acct,rIncome_desc:c.rIncome_desc,clearing_acct:c.clearing_acct,clearing_desc:c.clearing_desc}}a.regular_support.ar_form.others={aRTax_code:c.aRTax_code,cMTax_code:c.cMTax_code,aPTax_code:c.aPTax_code},this.settings.config=a,this.processingUpdates("Regular Support successfully updated")}})}processingUpdates(e=""){this.regSuppForm.valid&&this._othersSettingsService.saveRegularSupport(this.settings.config).then(n=>{n.success&&(this.openSnackBar(e),this.onReloadData())})}apiSetup(){this._settingsService.getRegularSupportType().then(e=>{e.success&&(this.settings.regSupTypeSelect=e.data)}),this._settingsService.getGlAccounts({fatherNum:"216010000"}).then(e=>{e.success&&(this.settings.glAccountsIncome=e.data)}),this._settingsService.getGlAccounts({fatherNum:"711020000"}).then(e=>{e.success&&(this.settings.glAccountsReClass=e.data)}),this._settingsService.getGlAccounts({fatherNum:"116090000"}).then(e=>{e.success&&(this.settings.glAccountsClearing=e.data)}),this._settingsService.getTaxCode().then(e=>{e.success&&(this.settings.taxCodeSelect=e.data)}),this._othersSettingsService.getConfig().then(e=>{e.success&&(this.settings.config=e.data[0],this.regSuppForm.get("aRTax_code")?.setValue(this.settings.config.regular_support.ar_form.others.aRTax_code),this.regSuppForm.get("cMTax_code")?.setValue(this.settings.config.regular_support.ar_form.others.cMTax_code),this.regSuppForm.get("aPTax_code")?.setValue(this.settings.config.regular_support.ar_form.others.aPTax_code))})}onReloadData(){this.regSuppForm.reset()}initVarValues(){this.settings={},this.regSuppForm=this.createForm()}createForm(){return this._formBuilder.group({type:new r.NI({value:null}),income_acct:new r.NI({value:null,disabled:!0}),income_desc:new r.NI({value:null,disabled:!0}),rIncome_acct:new r.NI({value:null,disabled:!0}),rIncome_desc:new r.NI({value:null,disabled:!0}),clearing_acct:new r.NI({value:null,disabled:!0}),clearing_desc:new r.NI({value:null,disabled:!0}),aRTax_code:new r.NI({value:null}),cMTax_code:new r.NI({value:null}),aPTax_code:new r.NI({value:null})})}inputsValueChange(){this.regSuppForm.get("type")?.valueChanges.subscribe(e=>{const n=this.regSuppForm.get("income_acct"),a=this.regSuppForm.get("income_desc"),c=this.regSuppForm.get("rIncome_acct"),u=this.regSuppForm.get("rIncome_desc"),T=this.regSuppForm.get("clearing_acct"),v=this.regSuppForm.get("clearing_desc");if(e){const p=e.replace(" ","_");n?.reset(),a?.reset(),c?.reset(),u?.reset(),T?.reset(),v?.reset(),this.settings.config.regular_support.ar_form[p]&&(n?.enable(),a?.enable(),c?.enable(),u?.enable(),T?.enable(),v?.enable(),n?.setValue(this.settings.config.regular_support.ar_form[p].income_acct),a?.setValue(this.settings.config.regular_support.ar_form[p].income_desc),c?.setValue(this.settings.config.regular_support.ar_form[p].rIncome_acct),u?.setValue(this.settings.config.regular_support.ar_form[p].rIncome_desc),T?.setValue(this.settings.config.regular_support.ar_form[p].clearing_acct),v?.setValue(this.settings.config.regular_support.ar_form[p].clearing_desc))}else n?.disable(),a?.disable(),c?.disable(),u?.disable(),T?.disable(),v?.disable()}),this.regSuppForm.get("income_acct")?.valueChanges.subscribe(e=>{if(this.regSuppForm.get("income_desc")?.reset(),e){const n=this.settings.glAccountsIncome.find(a=>a.acct_code==e);n&&this.regSuppForm.get("income_desc")?.setValue(n.acct_name)}}),this.regSuppForm.get("rIncome_acct")?.valueChanges.subscribe(e=>{if(this.regSuppForm.get("rIncome_desc")?.reset(),e){const n=this.settings.glAccountsReClass.find(a=>a.acct_code==e);n.acct_name&&this.regSuppForm.get("rIncome_desc")?.setValue(n.acct_name)}}),this.regSuppForm.get("clearing_acct")?.valueChanges.subscribe(e=>{if(this.regSuppForm.get("clearing_desc")?.reset(),e){const n=this.settings.glAccountsClearing.find(a=>a.acct_code==e);n.acct_name&&this.regSuppForm.get("clearing_desc")?.setValue(n.acct_name)}})}openSnackBar(e){this._snackBar.open(e,null,{duration:3e3,horizontalPosition:"right",verticalPosition:"top"})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(It.g),t.Y36(qt.m),t.Y36(h.ux),t.Y36(N.R),t.Y36(r.qu))},o.\u0275cmp=t.Xpm({type:o,selectors:[["other-settings"]],viewQuery:function(e,n){if(1&e&&(t.Gf(l.BZ,5),t.Gf(f.NW,5),t.Gf(d.YE,5)),2&e){let a;t.iGM(a=t.CRH())&&(n.table=a.first),t.iGM(a=t.CRH())&&(n.paginator=a.first),t.iGM(a=t.CRH())&&(n.sort=a.first)}},decls:66,vars:9,consts:[[1,"h-full","min-h-300","max-h-fit","p-4"],[1,"w-full"],[1,"text-xl","font-bold","mb-4"],[1,"bg-card","py-3","px-6","rounded","shadow","grid","grid-cols-1","md:grid-cols-12","gap-4"],[1,"col-span-2","place-items-start"],[1,"text-lg","mt-5"],[1,"col-span-10"],[3,"formGroup"],["formControlName","type"],[3,"value",4,"ngFor","ngForOf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","number","matInput","","formControlName","income_acct","list","income_acct"],["id","income_acct"],["matInput","","formControlName","income_desc","readonly",""],["type","number","matInput","","formControlName","rIncome_acct","list","rIncome_acct"],["id","rIncome_acct"],["matInput","","formControlName","rIncome_desc","readonly",""],["type","number","matInput","","formControlName","clearing_acct","list","clearing_acct"],["id","clearing_acct"],["matInput","","formControlName","clearing_desc","readonly",""],["formControlName","aRTax_code"],["formControlName","cMTax_code"],["formControlName","aPTax_code"],[1,"flex","justify-end"],["mat-raised-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"section",1)(2,"h2",2),t._uU(3,"Regular Support"),t.qZA(),t.TgZ(4,"div",3)(5,"div",4)(6,"h3",5),t._uU(7,"AR Form Autofill"),t.qZA()(),t.TgZ(8,"div",6)(9,"form",7)(10,"mat-form-field")(11,"mat-label"),t._uU(12,"Type"),t.qZA(),t.TgZ(13,"mat-select",8),t.YNc(14,Vt,2,2,"mat-option",9),t.qZA()(),t.TgZ(15,"div",10)(16,"mat-form-field")(17,"mat-label"),t._uU(18,"Income Account"),t.qZA(),t._UZ(19,"input",11),t.TgZ(20,"datalist",12),t.YNc(21,Bt,2,2,"option",9),t.qZA()(),t.TgZ(22,"mat-form-field")(23,"mat-label"),t._uU(24,"Income Account Description"),t.qZA(),t._UZ(25,"input",13),t.qZA(),t.TgZ(26,"mat-form-field")(27,"mat-label"),t._uU(28,"ReClass Income GL Account"),t.qZA(),t._UZ(29,"input",14),t.TgZ(30,"datalist",15),t.YNc(31,Qt,2,2,"option",9),t.qZA()(),t.TgZ(32,"mat-form-field")(33,"mat-label"),t._uU(34,"ReClass Income Account Description"),t.qZA(),t._UZ(35,"input",16),t.qZA(),t.TgZ(36,"mat-form-field")(37,"mat-label"),t._uU(38,"Clearing Account"),t.qZA(),t._UZ(39,"input",17),t.TgZ(40,"datalist",18),t.YNc(41,Ot,2,2,"option",9),t.qZA()(),t.TgZ(42,"mat-form-field")(43,"mat-label"),t._uU(44,"Clearing Account Description"),t.qZA(),t._UZ(45,"input",19),t.qZA()(),t._UZ(46,"hr"),t.TgZ(47,"div")(48,"mat-form-field")(49,"mat-label"),t._uU(50,"AR Tax Code"),t.qZA(),t.TgZ(51,"mat-select",20),t.YNc(52,Jt,2,2,"mat-option",9),t.qZA()(),t.TgZ(53,"mat-form-field")(54,"mat-label"),t._uU(55,"CM Tax Code"),t.qZA(),t.TgZ(56,"mat-select",21),t.YNc(57,kt,2,2,"mat-option",9),t.qZA()(),t.TgZ(58,"mat-form-field")(59,"mat-label"),t._uU(60,"AP Tax Code"),t.qZA(),t.TgZ(61,"mat-select",22),t.YNc(62,jt,2,2,"mat-option",9),t.qZA()()(),t.TgZ(63,"div",23)(64,"button",24),t.NdJ("click",function(){return n.saveRegularSupport()}),t._uU(65,"Save"),t.qZA()()()()()()()),2&e&&(t.xp6(9),t.Q6J("formGroup",n.regSuppForm),t.xp6(5),t.Q6J("ngForOf",n.settings.regSupTypeSelect),t.xp6(7),t.Q6J("ngForOf",n.settings.glAccountsIncome),t.xp6(10),t.Q6J("ngForOf",n.settings.glAccountsReClass),t.xp6(10),t.Q6J("ngForOf",n.settings.glAccountsClearing),t.xp6(11),t.Q6J("ngForOf",n.settings.taxCodeSelect),t.xp6(5),t.Q6J("ngForOf",n.settings.taxCodeSelect),t.xp6(5),t.Q6J("ngForOf",n.settings.taxCodeSelect),t.xp6(2),t.Q6J("disabled",!n.regSuppForm.valid))},dependencies:[S.sg,r._Y,r.YN,r.Kr,r.Fj,r.wV,r.JJ,r.JL,r.sg,r.u,C.lW,g.KE,g.hX,x.gD,Z.ey,y.Nt],encapsulation:2}),o})();function Pt(o,i){1&o&&(t.TgZ(0,"mat-icon",6),t._uU(1,"supervised_user_circle"),t.qZA(),t._uU(2," Accounts "))}function Mt(o,i){1&o&&(t.TgZ(0,"mat-icon",6),t._uU(1,"list_alt"),t.qZA(),t._uU(2," Audit "))}function Ht(o,i){1&o&&(t.TgZ(0,"mat-icon",6),t._uU(1,"settings"),t.qZA(),t._uU(2," Other "))}const $t=[{path:"",component:(()=>{class o{constructor(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["settings"]],decls:16,vars:0,consts:[[1,"flex","flex-col","flex-auto","w-full"],[1,"flex-auto","p-4","sm:p-4"],[1,"h-full","min-h-300","max-h-fit","p-4"],[1,"text-3xl","font-bold"],[1,"mt-5"],["mat-tab-label",""],[1,"example-tab-icon"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"Settings"),t.qZA(),t.TgZ(5,"section",4)(6,"mat-tab-group")(7,"mat-tab"),t.YNc(8,Pt,3,0,"ng-template",5),t._UZ(9,"account"),t.qZA(),t.TgZ(10,"mat-tab"),t.YNc(11,Mt,3,0,"ng-template",5),t._UZ(12,"audit"),t.qZA(),t.TgZ(13,"mat-tab"),t.YNc(14,Ht,3,0,"ng-template",5),t._UZ(15,"other-settings"),t.qZA()()()()()())},dependencies:[A.Hw,_.SP,_.uD,_.uX,mt,Rt,Gt],encapsulation:2}),o})(),data:{role:w.uU.ADMIN}}];let Et=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[S.ez,r.u5,r.UX,C.ot,I.FA,m.Is,A.Ps,Z.XK,f.TU,x.LD,h.ZX,d.JX,l.p0,q.AV,g.lN,y.c,Z.si,B.p9,Q.Tx,O.To,J.T5,_.Nh,k.ie,j.QW,G.rP,V.Fk,P.Bb,M.u,_.Nh,R.Bz.forChild($t)]}),o})()}}]);